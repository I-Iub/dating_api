Ссылка не проект: [https://hero-dating.herokuapp.com/api/](https://hero-dating.herokuapp.com/api/).
Примеры запросов в файле `dating/api/api_requests.http`.

---
## Примеры запросов к API
#### Зарегистрировать нового пользователя
Отправить POST-запрос на эндпоинт `http://<domain>/api/clients/create/`.
В запросе передать:
```
{
    "avatar": "data:image/png;base64, ... ",    # картинка должна передаваться в base64
    "gender": "Male",                           # выбрать из вариантов: "Male", "Female"
    "first_name": "<first_name>",
    "last_name": "<last_name>",
    "email": "<email>",
    "password": "<password>"
}
```
---
#### Получить токен
Отправить POST-запрос (Content-Type: application/json) на эндпоинт `http://<domain>/api/clients/login/`.
В запросе передать:
```
{
    "email": "<email>",
    "password": "<password>"
}
```
В ответ вернётся токен:
```
{
  "token": "<token>"
}
```
---
#### Удалить токен
Для разлогинивания авторизованный пользователь должен передать POST-запрос на эндпоинт `http://<domain>/api/clients/logout/`.
При этом необходимо передать токен в формате `Authorization: Token <token083fd1627023118ee8f5b344850ftoken>`.

---
#### Поставить оценку кандидату
Для того, чтобы клиент поставил оценку кандидату, нужно отправить POST-запрос на эндпоинт ` http://<domain>/api/clients/<candidate_id>/match/`. Здесь `<candidate_id>` -- это первичный ключ записи "кандидата" в модели пользователя (User).  Доступно только авторизованному пользователю.
В теле запроса передать:
```
{
    "like": "true" # или "false", если кандидат не интересен
}
```
Если два пользователя поставят друг другу оценки `"like": "true"`, то каждому из них на электронную почту поступит сообщение, в котором будет указан адрес электронной почты друг друга. Адрес электронной почты администратор, с которой всем поступают сообщения необходимо указать в `settings.ADMIN_EMAIL`.

---
#### Изменить оценку кандидату
Для того, чтобы изменить оценку, необходимо отправить POST- или PATCH-запрос так же, как указано в предыдущем пункте. При попытке отправить PATCH-запрос на эндпоинт, где в параметре <candidate_id> указан первичный ключ кандидата, которому ещё не ставилась оценка (т.е. соответствующей записи в базе данных нет), вернётся ответ со статусом HTTP_400_BAD_REQUEST.
Если после изменения оценки одного участника другим их оценки друг друга `"like": "true"`, то каждому из них будет отправлено электронное письмо, содержащее адрес электронной почты друг друга.

---
#### Получение списка участников
Для получения списка всех пользователей необходимо отправить GET-запрос на эндпоинт `http://<domain>/api/list/`. Доступно только авторизованному пользователю. Запросы кроме GET не разрешены.
Доступна фильтрация участников по полу, имени и фамилии. Для фильтрации необходимо добавить параметры `gender`, `first_name` и/или `last_name`. Например:
```
http://<domain>/api/list/?gender=Female                         # отфильтровать по полу
http://<domain>/api/list/?gender=Female&last_name=<surname>     # отфильтровать по полу и фамилии
```
Можно добавить поиск (параметр `search`):
```
http://<domain>/api/list/?gender=Female&search=<name or surname>
```
Поиск идёт по имени и фамилии по условию "начинается с".

---
#### Фильтрация по расстоянию
Для фильтрации по расстоянию до кандидатов, необходимо передать параметр `distance`. Значение расстояния необходимо указывать в километрах. Будут выведены кандидаты, расстояние до которых менее заданного параметром.
```
http://<domain>/api/list/?gender=Female&distance=59
```

---
## Заметки
1) Есть случаи, когда фильтр по расстоянию некорректно работает при тупых центральных углах между участниками. Вероятно это связано с тем какой результат получается после вычисления котангенса. Стоит попробовать использовать PostGIS.
2) Необходимо изменить логику отправки сообщений. Нужно исключить их отправку, если изменения состояния в оценках не произошло (при повторном PATCH-запросе).